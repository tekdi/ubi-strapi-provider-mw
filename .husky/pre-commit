echo ""
echo ">>> ğŸ¤–ğŸ” Running pre-commit hook... <<<"
echo "1. ğŸ› ï¸  Running build dry run to check compilation..."

# Run nest build dry run (TypeScript compilation check)
if npm run build --silent > /dev/null 2>&1; then
  echo "âœ… Build dry run successful - code compiles without errors"
  
  # Clean up build artifacts if they were created
  if [ -d "dist" ]; then
    rm -rf dist
    echo "ğŸ§¹ Cleaned up build artifacts"
  fi
  
  echo "ğŸ‰ Build validation passed - proceeding with commit!"
  exit 0
else
  echo "âŒ Build dry run failed - code has compilation errors"
  echo ""
  echo "Please fix the TypeScript compilation errors before committing."
  echo "Run 'npm run build' to see detailed error messages."
  echo ""
  exit 1
fi
